# workflow 의 이름
name: Run Test

on:
  push:
    tags:
      - "v*"

# workflow의 실행은 하나 이상의 job으로 구성 됨
jobs:
  build-and-test:

    runs-on: macos-latest
    env:
      XCWORKSPACE: ICO-iOS/ICO-iOS.xcworkspace
      PROJECT: ICO-iOS.xcodeproj
      SCHEME: ICO-iOS
      CONFIGURATION: Debug
      DESTINATION: platform=iOS Simulator,name=iPad Pro (9.7-inch),OS=latest
      
    steps:
    # step 1
    - name: Checkout source code
      uses: actions/checkout@v2
    
    # step 2
    - name: Select Xcode
      run: sudo xcode-select -switch /Applications/Xcode.app

    # step 3
    - name: Build and Test
      run: |
        pod install --repo-update --clean-install --project-directory=ICO-iOS/
        xcodebuild clean build test -workspace ICO-iOS/ICO-iOS.xcworkspace -scheme ICO-iOS -destination 'platform=iOS Simulator,name=iPhone 12 Pro,OS=latest'
